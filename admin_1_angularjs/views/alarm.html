<div class="page-bar">
    <ul class="page-breadcrumb">
        <!-- <li> -->
            <!-- <a href="devopt.html">设备监控</a> -->
            <!-- <span>设备监控</span> -->
            <!-- <i class="fa fa-circle"></i>
        </li> -->
        <li>
           <i class="fa fa-circle"></i>
            <span>报警中心</span>
        </li>
    </ul>
</div>
<br class="">
<div class="row">
    <div class="col-md-12">
        <div class="portlet light ">
            <div class="portlet-title tabbable-line tabbable-bordered" style="margin-top:-20px;">
                <ul class="nav nav-tabs pull-left">
                    <li class="active">
                        <a data-target="#tab_1" data-toggle="tab">活跃报警</a>
                    </li>
                    <li>
                        <a data-target="#tab_2" data-toggle="tab">历史报警</a>
                    </li>
                </ul>
            </div>
            <div class="portlet-body">
                <div class="tab-content">
                    <!-- PRIVACY SETTINGS TAB -->
                    <div class="tab-pane active open" id="tab_1">
                        <div class="row">
                              <script type="text/ng-template" id="headerCheckbox.html">
                                <label class="mt-checkbox mt-checkbox-single mt-checkbox-outline">
                                    <input type="checkbox" ng-model="checkboxes.checked" class="select-all" value="" /><span></span>
                                </label>
                              </script>
                              <table ng-table="table_alarm"  class="table table-striped table-bordered table-hover table-checkable order-column" style="margin-top: 5px">
                                  <tbody>
                                      <tr class="odd gradeX" ng-repeat="param in  $data" style=" text-align: center;">
                                          <td header="'headerCheckbox.html'">
                                            <label class="mt-checkbox mt-checkbox-single mt-checkbox-outline">
                                            <input type="checkbox" ng-model="checkboxes.items[param.alarmId]" /><span></span>
                                            </label>
                                          </td>
                                          <td title="'报警设备'">{{param.equipmentName}}</td>
                                          <td title="'报警时间'" class="center">{{param.alarmTime | date:'yyyy-MM-dd HH:mm:ss'}}</td>
                                          <td title="'报警参数'">{{param.equipmentModelPropertyName}}</td>
                                          <td title="'报警值'">{{param.alarmValue}}</td>
                                          <td title="'内容'">{{param.alarmContent}}</td>
                                      </tr>
                                  </tbody>
                              </table>
                        </div>
                    </div>
                    <div class="tab-pane" id="tab_2">

                        <div class="row">
                          <div class=" margin-bottom-20">
                              <div class="margin-top-10 margin-bottom-20 pull-right" style="margin:10px">
                                  <div class="margin-top-10 pull-left" style="width: 220px;" >
                                      <span style="width: 70px;margin-top:8px" class='pull-left'>报警类型:&nbsp</span>
                                      <ui-select ng-model="alarmtype" class='pull-left'  style="width: 140px" theme="bootstrap">
                                          <ui-select-match>{{alarmtype.name}}</ui-select-match>
                                          <ui-select-choices repeat="var in alartypelist ">
                                              <div ng-bind-html="var.name" ng-click="setAlarmType(var)"></div>
                                          </ui-select-choices>
                                      </ui-select>
                                  </div>
                                  <div class="margin-top-10 pull-left" style="width: 220px" >
                                      <span style="width: 70px;margin-top:8px" class='pull-left'>报警设备:&nbsp</span>
                                      <ui-select ng-model="equipment" class='pull-left' style="width: 140px" theme="bootstrap">
                                          <ui-select-match>{{equipment.name}}</ui-select-match>
                                          <ui-select-choices repeat="var in equipmentlist ">
                                              <div ng-bind-html="var.name" ng-click="setAlarmEquipment(var)"></div>
                                          </ui-select-choices>
                                      </ui-select>
                                  </div>
                                  <div class="margin-top-10 pull-left" style="width: 400px">
                                      <span style="width: 70px;margin-top:8px" class='pull-left'>报警时间:&nbsp</span>
                                      <div class="input-group input-large input-daterange pull-left" >
                                          <input type="text" class="form-control date start_date" style="width: 150px" placeholder="选择开始时间"/>
                                          <span class="input-group-addon"style="width: 20px"> ~ </span>
                                          <input type="text" class="form-control date end_date" style="width: 150px" placeholder="选择结束时间"/>
                                      </div>
                                  </div>
                                  <div class="margin-top-10 pull-left" style="width: 50px">
                                    <button class="btn btn-sm green table-group-action-submit" style="margin-top-10" ng-click='searchAlarm()'>
                                        <i class="fa fa-search"></i> 查询
                                    </button>
                                  </div>
                              </div>

                              <table ng-table="table_historyalarm" class="table table-striped table-bordered table-hover table-checkable order-column" style="margin-top: 5px">
                              <tbody>
                                  <!-- <tr class="odd gradeX" ng-repeat="param in  $data" style=" text-align: center;">
                                      <td title="'设备'" filter="{ equipmentName: 'text'}" sortable="'equipmentName'">{{param.equipmentName}}</td>
                                      <td title="'报警时间'" filter="{ alarmTime: 'number'}" sortable="'alarmTime'" class="center">{{param.alarmTime}}</td>
                                      <td title="'报警参数'" filter="{ equipmentModelPropertyName: 'text'}" sortable="'equipmentModelPropertyName'">{{param.equipmentModelPropertyName}}</td>
                                      <td title="'报警值'" filter="{ alarmValue: 'text'}" sortable="'alarmValue'">{{param.alarmValue}}</td>
                                      <td title="'内容'" filter="{ alarmContent: 'text'}" sortable="'alarmContent'">{{param.alarmContent}}</td>
                                      <td title="'状态'" filter="{ alarmStatus: 'text'}" sortable="'alarmStatus'">{{param.alarmStatus}}</td>
                                  </tr> -->
                                  <tr class="odd gradeX" ng-repeat="param in  $data" style=" text-align: center;">
                                      <td title="'设备'" >{{param.equipmentName}}</td>
                                      <td title="'报警时间'" class="center">{{param.alarmTime}}</td>
                                      <td title="'报警参数'"  >{{param.equipmentModelPropertyName}}</td>
                                      <td title="'报警值'" >{{param.alarmValue}}</td>
                                      <td title="'内容'" >{{param.alarmContent}}</td>
                                      <td title="'状态'" >{{param.alarmStatus}}</td>
                                      <td title="'详情'" >
                                        <div >
                                          <a href="#" data-toggle="modal" ng-click="showalarmcontent(param)" class="btn btn-sm btn-success sbold blue "><i class="fa fa-plus"></i>查看
                                          </a>
                                        </div>
                                      </td>
                                  </tr>
                              </tbody>
                          </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- END PROFILE CONTENT -->
    </div>
</div>
<div id="myModal_historydetail" class="modal fade" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                <h4 class="modal-title">报警详情</h4>
            </div>
            <div class="modal-body">
              <div class="container-fluid">
                <div class="row margin-bottom-10">
                  <div class="col-md-3 text-right "><strong>报警设备：</strong></div>
                  <div class="col-md-9  text-left ">{{currentItem.equipmentName}}</div>
                  <div class="col-md-3 text-right"><strong>报警状态：</strong></div>
                  <div class="col-md-9 text-left">
                    <button type="button" class="btn btn-primary btn-xs" style="">
                         {{currentItem.alarmStatus}}
                    </button>
                  </div>
                </div>

                <div class="row margin-bottom-10">
                  <div class="col-md-3 text-right"><strong>报警参数：</strong></div>
                  <div class="col-md-9  text-left">{{currentItem.equipmentModelPropertyName}}</div>
                  <div class="col-md-3 text-right"><strong>报警阈值：</strong></div>
                  <div class="col-md-9  text-left">{{currentItem.alarmContent}}</div>
                </div>
                <div class="row margin-bottom-10">
                  <div class="col-md-3 text-right"><strong>报警时间：</strong></div>
                  <div class="col-md-9  text-left">{{currentItem.alarmTime}}</div>
                  <div class="col-md-3 text-right"><strong>报警值：</strong></div>
                  <div class="col-md-9  text-left">{{currentItem.alarmValue}}</div>
                </div>

                <div class="row margin-bottom-10" ng-show="currentItem.isClear">
                  <div class="col-md-3 text-right"><strong>报警取消时间：</strong></div>
                  <div class="col-md-9  text-left">{{currentItem.updateTime}}</div>
                  <div class="col-md-3 text-right"><strong>报警取消值：</strong></div>
                  <div class="col-md-9 text-left ">{{currentItem.alarmClearValue}}</div>
                </div>

                <div class="row margin-bottom-10">
                  <div class="col-md-3 text-right"><strong>报警提醒对象：</strong></div>
                  <div class="col-md-9  text-left">{{currentItem.alarmTargetUser}}</div>
                </div>
              </div>
            </div>
            <div class="modal-footer ">
                <button type="button" class="btn green btn-outline col-md-offset-5 col-md-2" data-dismiss="modal" ng-click="disdetail()">关闭</button>
            </div>
        </div>
    </div>
</div>
<div id="myModal_alert" class="modal fade" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                <h4 class="modal-title">提示</h4>
            </div>
            <div class="
            ">{{message}}</div>
            <div class="modal-footer">
                <button type="button" class="btn green"  ng-click='disalert()'>
                    <i class="fa fa-check"></i> 确定 </button>
            </div>
        </div>
    </div>
</div>
